install.packages(c("admiral", "sdtm.oak", "gt", "ggplot2"))
install.packages("pharmaverse")
head(ds_raw)
install.packages("remotes")
install.packages(c("admiral", "sdtm.oak", "gt", "ggplot2"))
# Load libraries
library(sdtm.oak)
library(pharmaverseraw)
# Load raw dataset
ds_raw <- pharmaverseraw::ds_raw
head(ds_raw)
View(ds_raw)
# Load study controlled terminology (study_ct file)
study_ct <- read.csv("https://github.com/pharmaverse/examples/blob/main/metadata/sdtm_ct.csv")
View(study_ct)
# Load study controlled terminology (study_ct file)
study_ct <- read.csv("https://github.com/pharmaverse/examples/blob/main/metadata/sdtm_ct.csv",
stringsAsFactors = FALSE)
View(study_ct)
library(readr)
sdtm_ct <- read_csv("Coding_Assessment_RamonWinkler/sdtm_ct.csv")
View(sdtm_ct)
View(sdtm_ct)
View(study_ct)
head(study_ct)
head(sdtm_ct)
head(ds_terms)
head(ds_terms)
# only use the "C66727" that is relevant for the disposition (ds) domain
ds_terms <- sdtm_ct %>%
filter(codelist_code == "C66727")   # C66727 = DS domain
# Load study controlled terminology (study_ct file)
sdtm_ct<- read.csv("sdtm_ct <- read_csv("Coding_Assessment_RamonWinkler/sdtm_ct.csv")") # contains the standardized cdisc terms
head(ds_terms)
# Load study controlled terminology (study_ct file)
sdtm_ct <- read_csv("Coding_Assessment_RamonWinkler/question_1_sdtm/sdtm_ct.csv") # contains the standardized cdisc terms
head(sdtm_ct)
head(ds)
# Map raw dataset to the ds domain from SDTM
ds <- ds_raw %>%
left_join(ds_terms, by = c("IT.DSTERM" = "collected_value")) %>%
transmute(
STUDYID = STUDY,
DOMAIN = "DS",
USUBJID = PATNUM,
DSSEQ = row_number(),
DSTERM = IT.DSTERM,
DSDECOD = term_value,
DSCAT = CATEGORY,
VISITNUM = VISITNUM,
VISIT = VISIT,
DSDTC = DSDTCOL,
DSSTDTC = DSDTCOL,
DSSTDY = as.numeric(as.Date(DSDTCOL, "%d-%m-%Y") - as.Date(START_DATE, "%d-%m-%Y") + 1)
)
library(dplyr) # like pandas
# Quick check
head(ds)
View(ds_raw)
head(ds)
head(ds)
View(ds_raw)
# Map raw dataset to the ds domain from SDTM
# Map raw dataset to DS domain
ds <- ds_raw %>%
# join to get the standardized term
left_join(ds_terms, by = c("IT.DSTERM" = "collected_value")) %>%
group_by(PATNUM) %>%
transmute(
STUDYID = STUDY,
DOMAIN = "DS",
USUBJID = PATNUM,
DSSEQ = row_number(),
DSTERM = IT.DSTERM,
DSDECOD = ifelse(!is.na(term_value), term_value, IT.DSDECOD),
DSCAT = OTHERSP,
VISITNUM = NA,                 # raw data doesn't have visit number
VISIT = INSTANCE,
DSDTC = DSDTCOL,
DSSTDTC = DSDTCOL,
DSSTDY = as.numeric(as.Date(DSDTCOL, "%d-%m-%Y") - min(as.Date(DSDTCOL, "%d-%m-%Y")) + 1)
) %>%
ungroup()
# Map raw dataset to the ds domain from SDTM
# Map raw dataset to DS domain
ds <- ds_raw %>%
# join to get the standardized term
left_join(ds_terms, by = c("IT.DSTERM" = "collected_value")) %>%
group_by(PATNUM) %>%
transmute(
STUDYID = STUDY,
DOMAIN = "DS",
USUBJID = PATNUM,
DSSEQ = row_number(),
DSTERM = IT.DSTERM,
DSDECOD = ifelse(!is.na(term_value), term_value, IT.DSDECOD),
DSCAT = OTHERSP,
VISITNUM = NA,                 # raw data doesn't have visit number
VISIT = INSTANCE,
DSDTC = DSDTCOL,
DSSTDTC = DSDTCOL,
DSSTDY = as.numeric(as.Date(DSDTCOL, "%d-%m-%Y") - min(as.Date(DSDTCOL, "%d-%m-%Y")) + 1)
) %>%
ungroup()
head(ds)
# Save dataset
write.csv(ds, "ds_sdtm.csv", row.names = FALSE)
# Save a log file to confirm it ran
writeLines("DS domain created successfully.", "ds_log.txt")
# Quick check
head(ds)
# Map raw dataset to the ds domain from SDTM
# Map raw dataset to DS domain
ds <- ds_raw %>%
# join to get the standardized term
left_join(ds_terms, by = c("IT.DSTERM" = "collected_value")) %>%
group_by(PATNUM) %>%
transmute(
STUDYID = STUDY,
DOMAIN = "DS",
USUBJID = PATNUM,
DSSEQ = row_number(),
DSTERM = IT.DSTERM,
DSDECOD = ifelse(!is.na(term_value), term_value, IT.DSDECOD),
DSCAT = OTHERSP,
VISIT = INSTANCE,
DSDTC = DSDTCOL,
DSSTDTC = DSDTCOL,
DSSTDY = as.numeric(as.Date(DSDTCOL, "%d-%m-%Y") - min(as.Date(DSDTCOL, "%d-%m-%Y")) + 1)
) %>%
ungroup()
# Load libraries
library(sdtm.oak)
library(pharmaverseraw) # to assess the raw dataset
library(dplyr) # like pandas
library(readr) # helps read csv files
# Load raw dataset
ds_raw <- pharmaverseraw::ds_raw
#head(ds_raw)
# Load study controlled terminology (study_ct file)
sdtm_ct <- read_csv("Coding_Assessment_RamonWinkler/question_1_sdtm/sdtm_ct.csv") # contains the standardized cdisc terms
#head(sdtm_ct)
# only use the "C66727" that is relevant for the disposition (ds) domain
ds_terms <- sdtm_ct %>%
filter(codelist_code == "C66727")
#head(ds_terms)
# Map raw dataset to the ds domain from SDTM
# Map raw dataset to DS domain
ds <- ds_raw %>%
# join to get the standardized term
left_join(ds_terms, by = c("IT.DSTERM" = "collected_value")) %>%
group_by(PATNUM) %>%
transmute(
STUDYID = STUDY,
DOMAIN = "DS",
USUBJID = PATNUM,
DSSEQ = row_number(),
DSTERM = IT.DSTERM,
DSDECOD = ifelse(!is.na(term_value), term_value, IT.DSDECOD),
DSCAT = OTHERSP,
VISIT = INSTANCE,
DSDTC = DSDTCOL,
DSSTDTC = DSDTCOL,
DSSTDY = as.numeric(as.Date(DSDTCOL, "%d-%m-%Y") - min(as.Date(DSDTCOL, "%d-%m-%Y")) + 1)
) %>%
ungroup()
head(ds)
# Save dataset
write.csv(ds, "ds_sdtm.csv", row.names = FALSE)
# Save a log file to confirm it ran
writeLines("DS domain created successfully.", "ds_log.txt")
# Quick check
head(ds)
# Save a log file to confirm it ran
writeLines("DS domain created successfully.", "ds_log.txt")
View(ds)
View(ds)
getwd()
# inspect created file
head(ds)
getwd()
# save dataset in question 1 folder
write.csv(ds, "Coding_Assessment_RamonWinkler/question_1_sdtm/ds_sdtm.csv", row.names = FALSE)
list.files("Coding_Assessment_RamonWinkler/question_1_sdtm")
# Save a log file to confirm it ran
wwriteLines("DS domain created successfully.", "Coding_Assessment_RamonWinkler/question_1_sdtm/ds_log.txt")
# Save a log file to confirm it ran
writeLines("DS domain created successfully.", "Coding_Assessment_RamonWinkler/question_1_sdtm/ds_log.txt")
ls
git add Coding_Assessment_RamonWinkler/question_1_sdtm/*
git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO.git
# inspect created file
head(ds)
git add Coding_Assessment_RamonWinkler/question_1_sdtm/ds_log.txt
git status
